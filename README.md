***
# JDBC 등장
DB 마다 커넥션 방법, SQL전달 방법, 결과를 받는 방법이 다르다.

때문에 DB를 변경하게 되면 애플리케이션의 코드도 같이 변경해야한다.

이 문제를 해결하기 위해 JDBC라는 자바 표준이 등장했다.
***
# JDBC 표준인터페이스
대표적으로 다음 3가 기능을 표준 인터페이로 정해서 제공한다.
> 연결 - java.sql.Connection
>
> 질의 - java.sql.Statement
>
> 응답 - java.sql.ResultSet

각각의 DB벤더에서 자신의 DB에 맞게 JDBC 인터페이스를 구현한 라이브러리 제공한다.

이를 ```JDBC Driver```라고 한다.
***
# JDBC DB Connection
JDBC가 제공하는 ```DriverManager```는 라이브러리에 등록된 DB Driver들을 관리하고, 커넥션을 획득하는 기능을 제공한다.

JDBC는 아래와 같은 방법으로 DB와 연결한다.

1. 애플리케이션에서 DB Connection이 필요하면 ```DriverManager.getConnection()```을 호출한다.
2. ```DriverManager```는 라이브러리에 등록된 ```JDBC Driver``` 목록을 자동으로 인식하고 이 드라이버들에게 url, 이름, 비밀번호 정보를 넘겨
커넥션을 획득 할 수 있는지 확인한다.
3. 커넥션을 처리할 수 있는 드라이버의 커넥션 구현체를 반환한다.

***
# 표준화의 한계
JDBC의 등장으로 많은 것이 편리해졌다.

하지만 DB마다 SQL, 데이터 타입 등이 달라 일부분만 공통화 했기 때문에 한계가 있다.

결국 DB를 변경하면 JDBC 코드는 변경하지 않아도 되지만 SQL은 해당 DB에 맞게 변경해야 한다.

JPA(Java Persistence API)를 사용하면 이렇게 각각의 DB 마다 다른 SQL정의의 문제도 많은 부분 해결할 수 있다.
***
# JDBC와 최신 DB 접근 기술
JDBC는 1977년에 출시된 오래된 기술이고 사용방법도 복잡하다.
그래서 최근에는 JDBC를 직접 사용하기 보다는 JDBC를 편리하게 사용할 수 있게 해주는 기술들을 사용한다.
대표적으로 SQL Mapper와 ORM 기술이 있다.

* SQL Mapper
  * 장점
    * SQL 응답결과를 객체로 편리하게 변환해준다.
    * JDBC의 반복코드를 제거해준다.
  * 단점
    * 개발자가 SQL을 직접 작성해야한다.
  * 대표기술
    * Spring JdbcTemplate, Mybatis
  
* ORM
    * 장점
      * 객체를 관계형 데이터베이스 테이블과 매핑해준다.
      * ORM기술이 개발자 대신 SQL을 동적으로 실행해준다.
      * 각각의 데이터베이스마다 다른 SQL을 사용하는 문제도 중간에서 해결해준다.
    * 단점
      * ORM이 동적으로 생성한 SQL은 때로는 개발자가 직접 작성한 SQL보다 느리거나 효율이 떨어질 수 있다.
    * 대표기술
      * JPA, 하이버네이트, 이클립스링크
***
# Connection Pool
데이터베이스 커넥션을 획들 할 때에는 많은 자원과 복잡한 과정을 거치게 된다. 사용자가 애플리케이션을 사용할 때 SQL을 실행하는 시간 뿐만 아니라 커넥션을 새로 만드는 시간까지 추가가 되어 응답속도에 영향을 준다.

이런 문제를 해결하는 아이디어가 ```Connection Pool```이라는 방법이다.
* 커넥션 풀 초기화
  * 애플리케이션을 시작하는 시점에 필요한 만큼 커넥션을 생성해 풀에 보관한다.
  * 커넥션 풀에 들어있는 커넥션들은 이미 데이터베이스와 연결이 되어있는 상태이기 때문에 즉시 데이터베이스에 SQL을 전달 할 수 있다.
* 커넥션 풀 사용
  * 애플리케이션은 이제 데이터베이스 드라이버를 통해 새로운 커넥션을 획득하는 것이 아니라 풀에 생성되어있는 커넥션을 가져다 쓰면된다.
  * 커넥션 풀은 커넥션을 요청하면 자신이 가지고 있는 커넥션 중 하나를 반환해준다.
  * 애플리케이션은 커넥션을 사용하고 종료시키는 것이 아니라 다음번에 다시 사용할 수 있도록 커넥션풀에게 커넥션을 반환한다.
* 대표적인 커넥션 풀 오픈소스
  * commons-dbcp2
  * tomcat-jdbc pool
  * Hikari CP
***
# DataSource
애플리케이션이 커넥션을 획득하는 방법은 ```DriverManager```를 사용하거나 ```ConnectionPool```을 사용하는 등 다양한 방법이 있다.


각 방법은 커넥션 획득방법, 사용법 등이 다르다. 이 때문에 커넥션 획득 방법을 변경하게 되면 마치 JDBC를 사용하지 않을때 데이터베이스를 변경하는 경우처럼 애플리케이션 코드에 변경이 필요한 문제가 발생한다.


이 문제를 해결하기 위해 커넥션 획득방법을 추상화한 ```DataSource```인터페이스가 등장하게 된다.
애플리케이션을 ```DataSource```인터페이스에 의존하도록 하면 커넥션 획득 방법을 변경해도 애플리케이션 코드는 변경하지 않아도 된다.